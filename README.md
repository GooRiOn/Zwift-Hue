![logo](./docs/zhue.png)

# Zwift-Hue
Philips Hue ligts automation based on power scrapped from Zwift.

# Idea
I've been riding on Zwift for a half a year now and I love it! Mostly because it pushed me towards better shape with each single workout. But as a "geek" I was trying to motivate myself even more with some tech wired into my "cycling ecosystem". An inspiration came after watching great cyclist from Poland on [Karol Classy Rider](https://www.youtube.com/watch?v=Vhw5O_2MI-8&t=426s) channel. He uses LED stripes plugged to Zwift which color matches power zone.

![karol](./docs/karol.png)

What a great idea! Lucukly I have some Philps Hue lamps already installed, so why not?

**I wanted to do the same!**

# How does it work?
So, to make that thing work we need three things:
1. Get "real time" power generated by rider on Zwift
2. Translate power into color that matches power zone calculated based on FTP
3. Set the Hue lights with the calculated color

### Getting the power from Zwift's API
First try on getting data has been based on [Zwift Packet Monitor](https://github.com/braddwalker/ZwiftPacketMonitor) project that exposes few events, including the one that is emmited by the player a.k.a rider. This unfortunatelly is not possible to be used due to the Zwift's encryption changes that put most of the "udp-packet-based" apporaches to en end.

Therfore, current implementation is based on long polling Zwift's API that I found inside [zwift-client](https://github.com/jsmits/zwift-client) written in Python. Thanks to that every second the rider's state is fetched and transformed further. The state contains multiple usefull information that I'm going to utilize in a future:
- Power
- Cadence
- Speed (km/h)
- HR
- Ride On
- Boosts

and many more! Full list can be found in [this](./src/Protos/zwift.proto) proto file.

### Calculating power zone color
Having a rider's power it's time to convert it to the specific color that matches power zone. Fortunatelly, Zwift provides easy to implement [formula](https://zwiftinsider.com/power-zone-colors/) for that:

![power_zones](./docs/power_zones.png)


### Setting Philips Hue lamps

# Features
